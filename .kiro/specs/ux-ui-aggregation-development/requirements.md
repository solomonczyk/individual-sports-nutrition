# Requirements Document

## Introduction

Данный документ определяет требования для следующего этапа разработки приложения "Individual Sports Nutrition" — персонализированного мобильного приложения для подбора спортивного питания на сербском рынке.

Проект находится на стадии завершения технической инфраструктуры (Week 3 - 60% complete). Следующий этап включает:
- Полноценную реализацию UX/UI интерфейса
- Механику работы приложения (user flows)
- Систему агрегации данных о продуктах и магазинах
- Интеграцию с партнёрскими площадками

Текущее состояние:
- ✅ Backend API (Node.js + Express) — готов
- ✅ AI Service (Python + FastAPI) — готов
- ✅ База данных (PostgreSQL + Redis) — готова
- ✅ 269+ автоматизированных тестов
- ⏳ Mobile App (React Native/Expo) — базовая структура
- ⏳ UX/UI экраны — требуют реализации
- ⏳ Агрегация продуктов — требует реализации

---

## Requirements

### Requirement 1: Онбординг и первичная настройка

**User Story:** Как новый пользователь, я хочу пройти понятный онбординг, чтобы быстро настроить приложение под свои потребности и понять его ценность.

#### Acceptance Criteria

1. WHEN пользователь впервые открывает приложение THEN система SHALL отобразить экран приветствия с кратким описанием ценности персонализации (3-4 слайда)
2. WHEN пользователь завершает просмотр приветственных слайдов THEN система SHALL предложить выбор языка интерфейса (sr, hu, ro, en, ru, uk)
3. WHEN пользователь выбирает язык THEN система SHALL сохранить выбор и применить локализацию ко всему интерфейсу
4. WHEN пользователь завершает онбординг THEN система SHALL перенаправить на экран регистрации/входа
5. IF пользователь уже проходил онбординг THEN система SHALL пропускать его при следующих запусках

---

### Requirement 2: Регистрация и аутентификация

**User Story:** Как пользователь, я хочу безопасно зарегистрироваться и входить в приложение, чтобы мои данные были защищены и доступны только мне.

#### Acceptance Criteria

1. WHEN пользователь выбирает регистрацию THEN система SHALL отобразить форму с полями: email, пароль, подтверждение пароля
2. WHEN пользователь вводит email THEN система SHALL валидировать формат в реальном времени
3. WHEN пользователь вводит пароль THEN система SHALL отображать индикатор надёжности пароля (минимум 8 символов, буквы + цифры)
4. WHEN пользователь отправляет форму регистрации с валидными данными THEN система SHALL создать аккаунт и автоматически авторизовать пользователя
5. WHEN пользователь выбирает вход THEN система SHALL отобразить форму с полями: email, пароль
6. WHEN пользователь вводит неверные учётные данные THEN система SHALL отобразить понятное сообщение об ошибке
7. WHEN пользователь успешно авторизуется THEN система SHALL сохранить JWT токен и перенаправить на главный экран или экран заполнения профиля здоровья (если профиль не заполнен)
8. WHEN пользователь нажимает "Забыл пароль" THEN система SHALL отправить ссылку для сброса на указанный email

---

### Requirement 3: Профиль здоровья пользователя

**User Story:** Как пользователь, я хочу ввести свои параметры здоровья, чтобы получить персонализированные рекомендации по спортивному питанию.

#### Acceptance Criteria

1. WHEN пользователь открывает экран профиля здоровья THEN система SHALL отобразить пошаговую форму (wizard) с прогресс-индикатором
2. WHEN пользователь на шаге "Базовые данные" THEN система SHALL запросить: пол, возраст, рост (см), вес (кг)
3. WHEN пользователь на шаге "Активность" THEN система SHALL предложить выбор уровня активности: сидячий, лёгкая активность, умеренная, высокая, очень высокая
4. WHEN пользователь на шаге "Цели" THEN система SHALL предложить выбор: набор массы, сушка/похудение, поддержание формы, выносливость
5. WHEN пользователь на шаге "Здоровье" THEN система SHALL предложить указать заболевания и противопоказания из предустановленного списка с возможностью добавления своих
6. WHEN пользователь на шаге "Лекарства" THEN система SHALL предложить указать принимаемые лекарства для проверки взаимодействий
7. WHEN пользователь завершает заполнение профиля THEN система SHALL сохранить данные и запустить расчёт персонализированных рекомендаций
8. IF пользователь пропускает необязательные поля THEN система SHALL использовать значения по умолчанию для расчётов
9. WHEN пользователь хочет изменить профиль THEN система SHALL позволить редактировать любой параметр с пересчётом рекомендаций

---

### Requirement 4: Персонализированные рекомендации

**User Story:** Как пользователь, я хочу получить персонализированный план питания и добавок, чтобы достичь своих спортивных целей безопасно.

#### Acceptance Criteria

1. WHEN профиль здоровья заполнен THEN система SHALL отобразить главный экран с персонализированным планом
2. WHEN система генерирует рекомендации THEN AI-модуль SHALL учитывать: пол, возраст, вес, рост, уровень активности, цели, заболевания, лекарства
3. WHEN рекомендации готовы THEN система SHALL отобразить карточки с рекомендованными добавками: название, дозировка, время приёма, объяснение "почему"
4. WHEN пользователь нажимает на карточку добавки THEN система SHALL отобразить детальную информацию: состав, противопоказания, способ применения
5. IF добавка конфликтует с заболеванием или лекарством пользователя THEN система SHALL исключить её из рекомендаций или отобразить предупреждение
6. WHEN пользователь хочет изменить рекомендации THEN система SHALL предложить альтернативные варианты добавок
7. WHEN параметры пользователя изменяются THEN система SHALL автоматически пересчитать рекомендации

---

### Requirement 5: Каталог продуктов и агрегация

**User Story:** Как пользователь, я хочу видеть доступные продукты спортивного питания с ценами и наличием в магазинах Сербии, чтобы выбрать оптимальный вариант для покупки.

#### Acceptance Criteria

1. WHEN пользователь открывает каталог THEN система SHALL отобразить список продуктов с фильтрами: тип (протеин, креатин, аминокислоты и т.д.), бренд, ценовой диапазон
2. WHEN система отображает продукт THEN карточка SHALL содержать: название, бренд, тип, цена (мин-макс), рейтинг, фото
3. WHEN пользователь нажимает на продукт THEN система SHALL отобразить детальную страницу: полный состав, макросы, описание, список магазинов с ценами
4. WHEN система агрегирует данные о продуктах THEN она SHALL собирать информацию из партнёрских магазинов: X Sport, NSSport, локальные сети
5. WHEN цена продукта изменяется в магазине THEN система SHALL обновить данные в течение 24 часов
6. WHEN пользователь ищет продукт THEN система SHALL поддерживать поиск по названию, бренду, типу на выбранном языке
7. WHEN продукт рекомендован пользователю THEN система SHALL отмечать его специальным индикатором "Рекомендовано для вас"

---

### Requirement 6: Сравнение цен и покупка

**User Story:** Как пользователь, я хочу сравнить цены на продукты в разных магазинах и легко перейти к покупке, чтобы сэкономить время и деньги.

#### Acceptance Criteria

1. WHEN пользователь просматривает продукт THEN система SHALL отобразить список магазинов с ценами, отсортированный по цене (от низкой к высокой)
2. WHEN магазин имеет продукт в наличии THEN система SHALL отображать статус "В наличии" с актуальной ценой
3. WHEN магазин не имеет продукт в наличии THEN система SHALL отображать статус "Нет в наличии" или скрывать магазин
4. WHEN пользователь нажимает "Купить" THEN система SHALL перенаправить на страницу продукта в партнёрском магазине (deep link или веб-ссылка)
5. WHEN пользователь добавляет продукт в избранное THEN система SHALL сохранить его в списке избранного с возможностью уведомления о снижении цены
6. WHEN цена на избранный продукт снижается THEN система SHALL отправить push-уведомление пользователю

---

### Requirement 7: Трекинг прогресса

**User Story:** Как пользователь, я хочу отслеживать свой прогресс (вес, параметры тела), чтобы видеть результаты и корректировать план.

#### Acceptance Criteria

1. WHEN пользователь открывает раздел "Прогресс" THEN система SHALL отобразить графики изменения веса и других параметров за выбранный период
2. WHEN пользователь добавляет новую запись THEN система SHALL сохранить: дату, вес, процент жира (опционально), заметки
3. WHEN данных достаточно для анализа (минимум 3 записи) THEN система SHALL отобразить тренд: набор/потеря веса, прогноз достижения цели
4. WHEN пользователь достигает промежуточной цели THEN система SHALL отобразить поздравление и предложить скорректировать план
5. WHEN прогресс отклоняется от плана THEN система SHALL предложить рекомендации по корректировке питания или тренировок

---

### Requirement 8: Уведомления и напоминания

**User Story:** Как пользователь, я хочу получать напоминания о приёме добавок и уведомления об изменениях, чтобы не пропускать важные моменты.

#### Acceptance Criteria

1. WHEN пользователь настраивает план приёма добавок THEN система SHALL предложить установить напоминания
2. WHEN наступает время приёма добавки THEN система SHALL отправить push-уведомление с названием добавки и дозировкой
3. WHEN пользователь отмечает приём добавки THEN система SHALL записать это в историю для аналитики
4. WHEN появляется новый продукт, соответствующий рекомендациям пользователя THEN система SHALL уведомить об этом
5. WHEN пользователь хочет отключить уведомления THEN система SHALL предоставить гранулярные настройки: по типу уведомлений

---

### Requirement 9: Мультиязычность

**User Story:** Как пользователь из Сербии или соседних стран, я хочу использовать приложение на своём языке, чтобы комфортно взаимодействовать с интерфейсом.

#### Acceptance Criteria

1. WHEN приложение запускается THEN система SHALL определить язык устройства и предложить его как язык по умолчанию
2. WHEN пользователь выбирает язык THEN система SHALL переключить весь интерфейс на выбранный язык
3. WHEN система отображает названия продуктов THEN она SHALL использовать локализованные названия из базы переводов
4. WHEN перевод отсутствует THEN система SHALL отображать название на английском языке как fallback
5. WHEN пользователь меняет язык в настройках THEN система SHALL применить изменения без перезапуска приложения

---

### Requirement 10: Админ-панель для управления контентом

**User Story:** Как администратор, я хочу управлять каталогом продуктов, брендов и магазинов, чтобы поддерживать актуальность данных.

#### Acceptance Criteria

1. WHEN администратор входит в админ-панель THEN система SHALL отобразить dashboard с ключевыми метриками: количество пользователей, продуктов, активных магазинов
2. WHEN администратор управляет продуктами THEN система SHALL позволить: добавлять, редактировать, удалять продукты с переводами
3. WHEN администратор управляет магазинами THEN система SHALL позволить: добавлять партнёрские магазины, настраивать API интеграции, управлять статусом
4. WHEN администратор управляет брендами THEN система SHALL позволить: добавлять бренды, указывать страну происхождения, статус верификации
5. WHEN администратор управляет противопоказаниями THEN система SHALL позволить: добавлять заболевания и лекарства с описаниями на всех языках
6. WHEN данные изменяются в админ-панели THEN система SHALL синхронизировать их с мобильным приложением в реальном времени

---

### Requirement 11: Система агрегации данных о продуктах

**User Story:** Как система, я должна автоматически собирать и обновлять данные о продуктах из партнёрских магазинов, чтобы пользователи видели актуальную информацию.

#### Acceptance Criteria

1. WHEN настроена интеграция с партнёрским магазином THEN система SHALL периодически (каждые 6-24 часа) запрашивать данные о продуктах
2. WHEN получены данные о продукте THEN система SHALL сопоставить их с существующими продуктами в базе по названию/SKU
3. IF продукт новый THEN система SHALL создать запись с флагом "требует модерации"
4. WHEN цена продукта изменилась THEN система SHALL обновить цену и сохранить историю изменений
5. WHEN продукт недоступен в магазине THEN система SHALL обновить статус наличия
6. WHEN возникает ошибка при получении данных THEN система SHALL логировать ошибку и уведомить администратора
7. WHEN администратор одобряет новый продукт THEN система SHALL сделать его видимым для пользователей

---

### Requirement 12: Интеграция с сербской кухней

**User Story:** Как пользователь из Сербии, я хочу получать рекомендации с учётом местной кухни, чтобы план питания был реалистичным и выполнимым.

#### Acceptance Criteria

1. WHEN система генерирует план питания THEN она SHALL учитывать популярные сербские блюда: плескавица, ћевапи, сарма, бурек
2. WHEN пользователь указывает предпочтения в еде THEN система SHALL адаптировать рекомендации под местные продукты
3. WHEN система рекомендует добавки THEN она SHALL учитывать доступность в сербских магазинах
4. WHEN пользователь выбирает "местные бренды" THEN система SHALL приоритизировать продукты сербских и региональных производителей

