# Implementation Plan

## Phase 1: UI Component Library & Foundation

- [ ] 1. Создать базовую UI библиотеку компонентов
  - [ ] 1.1 Создать компонент Button с вариантами стилей
    - Реализовать варианты: primary, secondary, outline, ghost
    - Добавить состояния: loading, disabled
    - Добавить размеры: sm, md, lg
    - Написать unit тесты
    - _Requirements: 1.1, 2.1_
  - [ ] 1.2 Создать компонент Input с валидацией
    - Реализовать типы: text, email, password, number
    - Добавить отображение ошибок inline
    - Добавить индикатор надёжности пароля
    - Написать unit тесты
    - _Requirements: 2.2, 2.3_
  - [ ] 1.3 Создать компоненты Card, Badge, Avatar
    - Card с вариантами shadow и padding
    - Badge с цветовыми вариантами
    - Avatar с fallback на инициалы
    - _Requirements: 4.3, 5.2_
  - [ ] 1.4 Создать компоненты ProgressBar и Skeleton
    - ProgressBar для wizard-форм
    - Skeleton для состояний загрузки
    - _Requirements: 3.1_
  - [ ] 1.5 Создать компоненты Modal и Toast
    - Modal с анимацией и backdrop
    - Toast для уведомлений (success, error, warning)
    - _Requirements: 2.6, 8.2_

- [ ] 2. Настроить систему навигации
  - [ ] 2.1 Создать структуру навигаторов
    - RootNavigator (Stack)
    - AuthNavigator (Stack)
    - MainTabNavigator (Bottom Tabs)
    - Написать тесты навигации
    - _Requirements: 1.4, 2.7_
  - [ ] 2.2 Настроить deep linking
    - Конфигурация для iOS и Android
    - Обработка ссылок на продукты и магазины
    - _Requirements: 6.4_

---

## Phase 2: Onboarding & Authentication

- [ ] 3. Реализовать онбординг
  - [ ] 3.1 Создать OnboardingScreen с слайдами
    - 3-4 слайда с описанием ценности приложения
    - Анимированные переходы между слайдами
    - Индикатор текущего слайда
    - Кнопки "Пропустить" и "Далее"
    - _Requirements: 1.1_
  - [ ] 3.2 Создать LanguageSelectScreen
    - Список языков с флагами (sr, hu, ro, en, ru, uk)
    - Сохранение выбора в AsyncStorage
    - Применение локализации
    - _Requirements: 1.2, 1.3, 9.1, 9.2_
  - [ ] 3.3 Реализовать логику пропуска онбординга
    - Проверка флага onboardingCompleted
    - Автоматический переход для повторных пользователей
    - _Requirements: 1.5_

- [ ] 4. Реализовать авторизацию
  - [ ] 4.1 Создать LoginScreen
    - Форма email/password
    - Валидация в реальном времени
    - Обработка ошибок авторизации
    - Ссылка на регистрацию и восстановление пароля
    - _Requirements: 2.5, 2.6_
  - [ ] 4.2 Создать RegisterScreen
    - Форма email/password/confirmPassword
    - Индикатор надёжности пароля
    - Валидация совпадения паролей
    - Автоматический вход после регистрации
    - _Requirements: 2.1, 2.2, 2.3, 2.4_
  - [ ] 4.3 Создать ForgotPasswordScreen
    - Форма ввода email
    - Отправка запроса на сброс
    - Подтверждение отправки
    - _Requirements: 2.8_
  - [ ] 4.4 Реализовать auth store и сервис
    - Redux slice для auth state
    - JWT token management (access + refresh)
    - Secure storage для токенов
    - Auto-refresh логика
    - _Requirements: 2.7_

---

## Phase 3: Health Profile

- [ ] 5. Реализовать профиль здоровья
  - [ ] 5.1 Создать HealthProfileSetupScreen (wizard)
    - Контейнер с progress indicator
    - Навигация между шагами
    - Сохранение промежуточного состояния
    - _Requirements: 3.1_
  - [ ] 5.2 Создать BasicInfoStep (шаг 1)
    - Поля: пол (select), возраст (number), рост (number), вес (number)
    - Валидация диапазонов значений
    - _Requirements: 3.2_
  - [ ] 5.3 Создать ActivityStep (шаг 2)
    - Выбор уровня активности (5 вариантов)
    - Визуальные карточки с описанием каждого уровня
    - _Requirements: 3.3_
  - [ ] 5.4 Создать GoalsStep (шаг 3)
    - Выбор цели: набор массы, сушка, поддержание, выносливость
    - Визуальные карточки с иконками
    - _Requirements: 3.4_
  - [ ] 5.5 Создать HealthStep (шаг 4)
    - Мультиселект заболеваний из предустановленного списка
    - Возможность добавления своих
    - Поле для аллергий
    - _Requirements: 3.5_
  - [ ] 5.6 Создать MedicationsStep (шаг 5)
    - Список принимаемых лекарств
    - Добавление/удаление лекарств
    - Опциональный шаг
    - _Requirements: 3.6_
  - [ ] 5.7 Реализовать health profile store и сервис
    - Redux slice для health profile
    - API интеграция с backend
    - Триггер пересчёта рекомендаций при сохранении
    - _Requirements: 3.7, 3.8, 3.9_

---

## Phase 4: Recommendations

- [ ] 6. Реализовать экран рекомендаций
  - [ ] 6.1 Создать RecommendationsScreen (главный экран)
    - Приветствие с именем пользователя
    - Список рекомендованных добавок (карточки)
    - Pull-to-refresh для обновления
    - Skeleton loading state
    - _Requirements: 4.1, 4.3_
  - [ ] 6.2 Создать RecommendationCard компонент
    - Название добавки, дозировка, время приёма
    - Иконка типа добавки
    - Кнопка "Подробнее"
    - Индикатор приоритета (essential/recommended/optional)
    - _Requirements: 4.3_
  - [ ] 6.3 Создать RecommendationDetailScreen
    - Полная информация о добавке
    - Объяснение "почему рекомендовано"
    - Противопоказания и предупреждения
    - Список магазинов с ценами
    - Кнопки "Купить" и "В избранное"
    - _Requirements: 4.4, 4.5, 4.6_
  - [ ] 6.4 Реализовать recommendations store и сервис
    - Redux slice для recommendations
    - API интеграция с AI service
    - Кэширование рекомендаций
    - _Requirements: 4.2, 4.7_

---

## Phase 5: Product Catalog

- [ ] 7. Реализовать каталог продуктов
  - [ ] 7.1 Создать CatalogScreen
    - Список продуктов с виртуализацией (FlashList)
    - Фильтры: тип, бренд, цена, наличие
    - Сортировка: по цене, рейтингу, названию
    - Индикатор "Рекомендовано для вас"
    - _Requirements: 5.1, 5.7_
  - [ ] 7.2 Создать ProductCard компонент
    - Фото, название, бренд, тип
    - Диапазон цен (мин-макс)
    - Рейтинг и количество отзывов
    - Бейдж "Рекомендовано"
    - _Requirements: 5.2_
  - [ ] 7.3 Создать ProductDetailScreen
    - Галерея фото
    - Полный состав и макросы
    - Описание продукта
    - Список магазинов с ценами (сортировка по цене)
    - Статус наличия
    - Кнопки "Купить" и "В избранное"
    - _Requirements: 5.3, 6.1, 6.2, 6.3_
  - [ ] 7.4 Создать SearchScreen
    - Поле поиска с debounce
    - История поиска
    - Подсказки при вводе
    - Результаты поиска
    - _Requirements: 5.6_
  - [ ] 7.5 Создать FilterModal компонент
    - Фильтр по типу продукта (мультиселект)
    - Фильтр по бренду (мультиселект)
    - Слайдер ценового диапазона
    - Чекбокс "Только в наличии"
    - Кнопки "Сбросить" и "Применить"
    - _Requirements: 5.1_
  - [ ] 7.6 Реализовать product store и сервис
    - Redux slice для products
    - API интеграция с backend
    - Пагинация и infinite scroll
    - Кэширование результатов
    - _Requirements: 5.4, 5.5_

- [ ] 8. Реализовать функционал покупки
  - [ ] 8.1 Создать StoreCard компонент
    - Логотип магазина, название
    - Цена и валюта
    - Статус наличия
    - Кнопка "Купить"
    - _Requirements: 6.1, 6.2, 6.3_
  - [ ] 8.2 Реализовать deep link переход в магазин
    - Открытие ссылки в браузере или приложении магазина
    - Tracking переходов для аналитики
    - _Requirements: 6.4_
  - [ ] 8.3 Реализовать избранное
    - Добавление/удаление из избранного
    - Экран списка избранного
    - Синхронизация с backend
    - _Requirements: 6.5_

---

## Phase 6: Progress Tracking

- [ ] 9. Реализовать трекинг прогресса
  - [ ] 9.1 Создать ProgressScreen
    - График изменения веса (линейный chart)
    - Выбор периода (неделя, месяц, 3 месяца, год)
    - Список записей с датами
    - Кнопка добавления новой записи
    - _Requirements: 7.1_
  - [ ] 9.2 Создать AddProgressModal
    - Поля: дата, вес, процент жира (опционально)
    - Поле для заметок
    - Валидация значений
    - _Requirements: 7.2_
  - [ ] 9.3 Создать ProgressChart компонент
    - Линейный график с точками
    - Интерактивные точки с tooltip
    - Линия тренда
    - _Requirements: 7.1, 7.3_
  - [ ] 9.4 Реализовать анализ прогресса
    - Расчёт тренда (набор/потеря/поддержание)
    - Прогноз достижения цели
    - Рекомендации при отклонении от плана
    - _Requirements: 7.3, 7.4, 7.5_
  - [ ] 9.5 Реализовать progress store и сервис
    - Redux slice для progress
    - API интеграция с backend
    - Локальное кэширование для офлайн
    - _Requirements: 7.2_

---

## Phase 7: Notifications

- [ ] 10. Реализовать систему уведомлений
  - [ ] 10.1 Настроить push notifications
    - Интеграция с Expo Notifications
    - Регистрация device token на backend
    - Обработка входящих уведомлений
    - _Requirements: 8.2, 8.4_
  - [ ] 10.2 Создать NotificationSettingsScreen
    - Переключатели по типам уведомлений
    - Напоминания о добавках
    - Уведомления о ценах
    - Новые продукты
    - _Requirements: 8.5_
  - [ ] 10.3 Реализовать напоминания о приёме добавок
    - Настройка расписания для каждой добавки
    - Локальные уведомления по расписанию
    - Отметка о приёме
    - _Requirements: 8.1, 8.2, 8.3_
  - [ ] 10.4 Реализовать уведомления о снижении цен
    - Подписка на изменение цены избранных продуктов
    - Push при снижении цены
    - _Requirements: 6.6_

---

## Phase 8: Localization

- [ ] 11. Реализовать мультиязычность
  - [ ] 11.1 Настроить i18n инфраструктуру
    - Конфигурация i18next
    - Загрузка локалей
    - Определение языка устройства
    - _Requirements: 9.1_
  - [ ] 11.2 Создать файлы локализации для всех языков
    - sr.json (сербский)
    - hu.json (венгерский)
    - ro.json (румынский)
    - en.json (английский)
    - ru.json (русский)
    - uk.json (украинский)
    - _Requirements: 9.2_
  - [ ] 11.3 Реализовать переключение языка
    - Экран выбора языка в настройках
    - Применение без перезапуска приложения
    - Сохранение выбора
    - _Requirements: 9.5_
  - [ ] 11.4 Интегрировать переводы из базы данных
    - Загрузка переводов названий продуктов
    - Fallback на английский при отсутствии перевода
    - _Requirements: 9.3, 9.4_

---

## Phase 9: Aggregation System

- [ ] 12. Реализовать систему агрегации данных
  - [ ] 12.1 Создать базовую инфраструктуру агрегации
    - Scheduler для периодических задач
    - Job queue для обработки
    - Логирование и мониторинг
    - _Requirements: 11.1_
  - [ ] 12.2 Реализовать интеграцию с X Sport
    - API клиент для X Sport
    - Парсер данных о продуктах
    - Маппинг на внутренние модели
    - _Requirements: 5.4, 11.1_
  - [ ] 12.3 Реализовать интеграцию с NSSport
    - API клиент для NSSport
    - Парсер данных о продуктах
    - Маппинг на внутренние модели
    - _Requirements: 5.4, 11.1_
  - [ ] 12.4 Реализовать Product Matcher
    - Сопоставление по SKU/EAN
    - Сопоставление по названию + бренду
    - Fuzzy matching для неточных совпадений
    - _Requirements: 11.2, 11.3_
  - [ ] 12.5 Реализовать обновление цен и наличия
    - Обновление цен в базе данных
    - Сохранение истории цен
    - Обновление статуса наличия
    - _Requirements: 5.5, 11.4, 11.5_
  - [ ] 12.6 Реализовать обработку ошибок и алерты
    - Логирование ошибок агрегации
    - Уведомление администратора при проблемах
    - Retry логика для временных ошибок
    - _Requirements: 11.6_
  - [ ] 12.7 Реализовать модерацию новых продуктов
    - Флаг "требует модерации" для новых продуктов
    - API для одобрения/отклонения
    - _Requirements: 11.3, 11.7_

---

## Phase 10: Admin Panel

- [ ] 13. Создать админ-панель
  - [ ] 13.1 Создать Dashboard
    - Метрики: пользователи, продукты, магазины
    - Графики активности
    - Статус агрегации
    - _Requirements: 10.1_
  - [ ] 13.2 Создать раздел управления продуктами
    - Таблица продуктов с фильтрами и поиском
    - Форма добавления/редактирования продукта
    - Управление переводами названий
    - Управление противопоказаниями
    - _Requirements: 10.2_
  - [ ] 13.3 Создать раздел управления магазинами
    - Список партнёрских магазинов
    - Настройка API интеграций
    - Статус и история синхронизации
    - _Requirements: 10.3_
  - [ ] 13.4 Создать раздел управления брендами
    - Список брендов
    - Добавление/редактирование брендов
    - Статус верификации
    - _Requirements: 10.4_
  - [ ] 13.5 Создать раздел управления противопоказаниями
    - Список заболеваний и лекарств
    - Переводы на все языки
    - Связи с продуктами
    - _Requirements: 10.5_
  - [ ] 13.6 Реализовать синхронизацию с мобильным приложением
    - Real-time обновления через WebSocket или polling
    - Инвалидация кэша при изменениях
    - _Requirements: 10.6_

---

## Phase 11: Serbian Cuisine Integration

- [ ] 14. Интегрировать сербскую кухню
  - [ ] 14.1 Создать базу сербских блюд
    - Популярные блюда: плескавица, ћевапи, сарма, бурек
    - Макросы для каждого блюда
    - Переводы названий
    - _Requirements: 12.1_
  - [ ] 14.2 Адаптировать рекомендации под местную кухню
    - Учёт предпочтений в еде
    - Рекомендации с учётом местных продуктов
    - _Requirements: 12.2_
  - [ ] 14.3 Приоритизировать локальные бренды
    - Фильтр "местные бренды"
    - Приоритет сербских и региональных производителей
    - _Requirements: 12.3, 12.4_

---

## Phase 12: Testing & Quality Assurance

- [ ] 15. Написать тесты
  - [ ] 15.1 Unit тесты для компонентов
    - Тесты для всех UI компонентов
    - Тесты для форм и валидации
    - Покрытие > 80%
    - _Requirements: все_
  - [ ] 15.2 Unit тесты для хуков и сервисов
    - Тесты для custom hooks
    - Тесты для API сервисов
    - Тесты для Redux slices
    - _Requirements: все_
  - [ ] 15.3 Integration тесты
    - Тесты user flows
    - Тесты навигации
    - Тесты API интеграции
    - _Requirements: все_
  - [ ] 15.4 E2E тесты
    - Полный flow регистрации
    - Полный flow настройки профиля
    - Полный flow просмотра и покупки продукта
    - _Requirements: все_

---

## Phase 13: Performance & Security

- [ ] 16. Оптимизация производительности
  - [ ] 16.1 Оптимизировать загрузку
    - Lazy loading экранов
    - Code splitting
    - Оптимизация bundle size
    - _Requirements: все_
  - [ ] 16.2 Оптимизировать изображения
    - WebP формат
    - Responsive images
    - Placeholder при загрузке
    - _Requirements: 5.2_
  - [ ] 16.3 Настроить кэширование
    - React Query кэширование
    - Персистентный кэш для офлайн
    - Инвалидация кэша
    - _Requirements: все_

- [ ] 17. Обеспечить безопасность
  - [ ] 17.1 Защитить аутентификацию
    - Secure storage для токенов
    - Auto-refresh токенов
    - Очистка данных при выходе
    - _Requirements: 2.7_
  - [ ] 17.2 Защитить данные пользователя
    - Шифрование чувствительных данных
    - Валидация на клиенте и сервере
    - _Requirements: 3.5, 3.6_
